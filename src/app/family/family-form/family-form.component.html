<mat-card *ngIf="!currentlyEditingFamilyMember&&mode=='cases'">
  <mat-card-header>
    <mat-card-title [className]="'familyFormTitle'">
      <h3><span>{{family.getFamilyNameLongForm()}}</span></h3>
    </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <p [style.margin]="'0 auto'">
      <label for="id">Case ID for Family:</label>
      <input mat-input #id type="text" id="id" name="id" value=""/>
    </p>
    <p *ngIf="family && family.familyMembers && family.familyMembers.length==0" class="no-members">No
      family
      members added yet.</p>
    <mat-list *ngIf="family">
      <mat-list-item *ngFor="let familyMember of family.familyMembers;index as index2">
        <cnstll-family-member-menu-item [familyMember]="familyMember"
                                        (selectFamilyMember)="doSelectFamilyAndFamilyMember($event)"
                                        (inspectFamilyMember)="doInspectFamilyMember($event)"
                                        [hasConsents]="hasConsents[familyMember.nhsNumber]"></cnstll-family-member-menu-item>
        <button mat-button [attr.data-index]="index2" class="family-member-edit-button"
                (click)="editFamilyMember(index2,familyMember)">Edit {{familyMember.firstName}}'s Details
        </button>
        <button mat-button [attr.data-index]="index2" class="family-member-consent-button"
                (click)="editConsent(index2,familyMember)">Edit {{familyMember.firstName}}'s Consent
        </button>
        <mat-divider [inset]="true"></mat-divider>
      </mat-list-item>
    </mat-list>
  </mat-card-content>
  <mat-card-actions>
    <button mat-button (click)="addFamilyMember($event)">Add a new family member...</button>
    <button mat-button (click)="saveFamily($event)">Save {{ family ?
      family.getFamilyNameLongForm() : 'family'}}
    </button>
    <button mat-button (click)="deleteFamily($event)">Delete the {{family.getFamilyName()}} family</button>
    <button mat-button (click)="closePanel()"><span [style.textAlign]="'center'">Back to Case List</span></button>
  </mat-card-actions>
</mat-card>
<cnstll-family-member-details-form *ngIf="currentlyEditingFamilyMember&&mode=='cases'"
                                   [indexOfFamilyMember]="indexOfCurrentlyEditingFamilyMember"
                                   [editing]="!isCurrentlyEditingFamilyMemberNew()"
                                   [familyMemberToEdit]="currentlyEditingFamilyMember"
                                   (newFamilyMemberSaver)="newFamilyMemberSaved($event)"
                                   (familyMemberDeleter)="deleteFamilyMember($event)"
                                   (editedFamilyMemberSaver)="editedFamilyMemberSaved($event)"
                                   (close)="familyMemberClosed($event)"></cnstll-family-member-details-form>
<cnstll-consent-screen *ngIf="mode=='consent'" [familyMember]="currentlyEditingFamilyMember"
                       [consented]="hasConsents[currentlyEditingFamilyMember.nhsNumber]=='true'"
                       (close)="familyMemberClosed($event)"></cnstll-consent-screen>
